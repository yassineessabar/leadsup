#!/usr/bin/env node

console.log('üìä HEALTH SCORE CALCULATION BREAKDOWN\n')
console.log('=====================================\n')

// The calculation from the code
console.log('FORMULA: Health Score = ')
console.log('  (Warmup Score √ó 25%) +')
console.log('  (Deliverability Score √ó 30%) +')
console.log('  (Engagement Score √ó 25%) +')
console.log('  (Volume Score √ó 10%) +')
console.log('  (Reputation Score √ó 10%)\n')

console.log('=====================================\n')

console.log('1Ô∏è‚É£ WARMUP SCORE (25% weight)\n')
console.log('   Data that improves it:')
console.log('   ‚Ä¢ Account age (0-30+ days)')
console.log('   ‚Ä¢ Sending days active (how many days you sent emails)')
console.log('   ‚Ä¢ Warmup status progression:')
console.log('     - "inactive" (new) = 50 points')
console.log('     - "warming_up" (7+ days) = 50-90 points')
console.log('     - "completed" (30+ days) = 100 points')
console.log('   ‚Ä¢ Consistent daily sending improves score\n')

console.log('2Ô∏è‚É£ DELIVERABILITY SCORE (30% weight)\n')
console.log('   Data that improves it:')
console.log('   ‚Ä¢ Low bounce rate (<1% = 100 points)')
console.log('   ‚Ä¢ Low block rate (<1% = bonus points)')
console.log('   ‚Ä¢ High delivery rate (>95% = +10 bonus)')
console.log('   Scoring:')
console.log('     - <1% failures = 100 points')
console.log('     - <2% failures = 90 points')
console.log('     - <5% failures = 75 points')
console.log('     - <10% failures = 50 points')
console.log('     - >10% failures = 25 points\n')

console.log('3Ô∏è‚É£ ENGAGEMENT SCORE (25% weight)\n')
console.log('   Data that improves it:')
console.log('   ‚Ä¢ Open rate (>25% = max points)')
console.log('     - >25% = 40 points')
console.log('     - >20% = 32 points')
console.log('     - >15% = 24 points')
console.log('     - >10% = 16 points')
console.log('   ‚Ä¢ Click rate (>5% = max points)')
console.log('     - >5% = 35 points')
console.log('     - >3% = 28 points')
console.log('     - >2% = 21 points')
console.log('   ‚Ä¢ Reply rate (>3% = max points)')
console.log('     - >3% = 25 points')
console.log('     - >2% = 20 points')
console.log('     - >1% = 15 points\n')

console.log('4Ô∏è‚É£ VOLUME SCORE (10% weight)\n')
console.log('   Data that improves it:')
console.log('   ‚Ä¢ Sending consistency (days active/30)')
console.log('   ‚Ä¢ Average daily volume (up to 50 emails/day)')
console.log('   ‚Ä¢ Recent activity (last 7 days)\n')

console.log('5Ô∏è‚É£ REPUTATION SCORE (10% weight)\n')
console.log('   Data that improves it:')
console.log('   ‚Ä¢ Account age:')
console.log('     - 6+ months = 70 points')
console.log('     - 3+ months = 60 points')
console.log('     - 1+ month = 50 points')
console.log('     - 1+ week = 40 points')
console.log('   ‚Ä¢ Low spam reports (<0.05% = no penalty)')
console.log('   ‚Ä¢ Low unsubscribe rate (<0.5% = no penalty)\n')

console.log('=====================================\n')
console.log('üìà HOW TO IMPROVE YOUR HEALTH SCORE:\n')
console.log('1. SEND CONSISTENTLY: Send emails daily, even if just a few')
console.log('2. START SMALL: Begin with 5-10 emails/day, increase gradually')
console.log('3. TARGET ENGAGED CONTACTS: Send to people likely to open/click')
console.log('4. AVOID SPAM TRIGGERS: Use good subject lines, avoid spam words')
console.log('5. MAINTAIN LISTS: Remove bounced emails immediately')
console.log('6. WARMUP SCHEDULE: Follow a 30-day gradual increase pattern')
console.log('   - Week 1: 5-10 emails/day')
console.log('   - Week 2: 10-20 emails/day')
console.log('   - Week 3: 20-35 emails/day')
console.log('   - Week 4: 35-50 emails/day')
console.log('7. GET ENGAGEMENT: Encourage replies, clicks on links')
console.log('8. MONITOR METRICS: Check your stats regularly\n')

console.log('=====================================\n')
console.log('üéØ CURRENT STATUS FOR YOUR SENDERS:\n')
console.log('Your senders show 75% because:')
console.log('‚Ä¢ No sending history yet (no emails sent)')
console.log('‚Ä¢ Default score when no data exists')
console.log('‚Ä¢ Will improve as soon as you start sending\n')

console.log('üìä DATA SOURCES (where scores come from):\n')
console.log('1. SendGrid Webhooks ‚Üí sendgrid_events table')
console.log('2. Daily aggregations ‚Üí sender_metrics table')
console.log('3. Summary metrics ‚Üí sender_summary_metrics table')
console.log('4. Campaign activity ‚Üí campaign_senders table\n')

console.log('üîÑ WHEN SCORES UPDATE:\n')
console.log('‚Ä¢ Real-time: As SendGrid sends webhook events')
console.log('‚Ä¢ On page load: When you view analytics')
console.log('‚Ä¢ Daily: Background jobs aggregate metrics')
console.log('‚Ä¢ During warmup: Warmup system updates scores\n')
